# Malware-Analysis-Lab
Using REMnux to do static analysis on malicious software

For this lab to work we will need a REMnux virtual machine and the training-sample malware that we can get from https://github.com/intezer/ELF-Malware-Analysis-101/tree/master/Part-2-Initial-Analysis/Article-samples. 

We will start by using the file command to learn more about our malware and we can also use md5sum to get the md5 hash which will be useful in a bit:

![remnux 1](https://github.com/user-attachments/assets/031614bb-6d22-4ea5-ba11-243bab0f23d3)

We can also use Detect It Easy to find more information like the language used to create the malware:

![remnux 2](https://github.com/user-attachments/assets/e36d5a9d-9307-4e53-9322-dbd4669cd25a)

Using the hash we just got we can check on virustotal to see if it is already recognized as malicious and we can see from the picture that it is not actually malicious since this sample is just for training purposes:

![remnux 3](https://github.com/user-attachments/assets/b6f51cbe-b8bc-4353-9ab3-26c183ce5782)

Using the readelf -s command we can see all the symbols in our sample in the first table we can see the dynamic table called dynsym which isn't from the source code it is from external libraries and the second table called symtab contains functions that can help us understand what this code is trying to do. For example in the 2nd picture we see ping google dns and we can infer that this fucntion when called will most likely ping google:

![remnux 4](https://github.com/user-attachments/assets/6cef9312-1067-431d-915a-668794968d39)

![remnux 5](https://github.com/user-attachments/assets/cb3e2298-a0c9-48e0-a137-2d04238651d5)

Using readelf -l command we can see the program headers and in the first LOAD we can see 2 permissions R E which means read and execute this is where the source code is. Looking for headers is important in case the malware would be packed in this case the malware is not packed as we can see multiple headers that wouldn't show up in a packed file:

![remnux 6](https://github.com/user-attachments/assets/5d989b4b-6665-4046-b703-13d0f73f5eee)

Luckily on the github repo there is a packed version of this sample we will use readelf -l to see how different the packed version will look:

![remnux 7](https://github.com/user-attachments/assets/05686c6b-3d45-4290-a7fc-2887312e74ca)

We can use Detect It Easy on our packed sample and we can find what packer is used:

![remnux 8](https://github.com/user-attachments/assets/b1062f11-2c5e-4749-b81b-4b60c522efaf)

From the picture above we can see that upx is and open source packer and with a little research we can use the command upx -d that will unpack this file for us:

![remnux 9](https://github.com/user-attachments/assets/22f03f3c-728c-4242-a14e-dae9ae93a0e7)

If we open up DIE again we will see that is it no longer packed:

![remnux 10](https://github.com/user-attachments/assets/dee67e98-7a7f-4358-8e48-c895a4a76de2)

Using the strings command can also give us more useful information about our sample and we see here that there is actually something encoded with base64 which I will go decode:

![remnux 11](https://github.com/user-attachments/assets/700ef2f4-f26c-4f66-a664-fcfc9b9ee143)

The base64 text is actually a command to make a request to a url but since this malware isn't real this link will go nowhere:

![remnux 12](https://github.com/user-attachments/assets/7f44a54b-0fd5-4d5c-9203-dc6e37140ed2)

Another extremely useful tool we can use is ghidra. We will create a new project and import the training-sample file in it:

![remnux 13](https://github.com/user-attachments/assets/2dd2cc12-8e7f-44b8-8f36-09761a6279cb)

We can double click on our file once we closed the previous window this will decompile the code and show us the source code:

![remnux 14](https://github.com/user-attachments/assets/625f3519-20cc-4ddc-9e7a-98b5d245fc78)

